(window.webpackJsonp=window.webpackJsonp||[]).push([[74],{420:function(s,n,a){"use strict";a.r(n);var e=a(25),t=Object(e.a)({},(function(){var s=this,n=s.$createElement,a=s._self._c||n;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("blockquote",[a("p",[s._v("最近在写网易云音乐微信小程序，发现项目中少了点什么东西，于是爆肝了几天，参考了很多网上的写法，最终实现了这个简单的登录功能！")])]),s._v(" "),a("p",[a("img",{attrs:{src:"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/06e56346a6314b6abb7a8fce7b5e4596~tplv-k3u1fbpfcp-zoom-1.image",alt:"在这里插入图片描述"}})]),s._v(" "),a("blockquote",[a("p",[s._v("注意，微信小程序是没有登出功能的，害的我找了半天的api，在平时的是使用中，退出小程序直接点右上角的小圆点，只要你第一次授权登录了，下次登录基本会记住你的头像信息，当然也不排除一些很蛋疼的小程序，每次都要重复授权！！")])]),s._v(" "),a("p",[a("img",{attrs:{src:"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/0ac8e3ed7ebd47e49728aaf2a7f2b1ef~tplv-k3u1fbpfcp-zoom-1.image",alt:"在这里插入图片描述"}})]),s._v(" "),a("blockquote",[a("p",[s._v("话不多说，请看代码")])]),s._v(" "),a("p",[s._v("index.vue")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('<template>\n <view class="index">\n  <musichead title="网易云音乐" :icon="false"></musichead>\n  <view class="container">\n   <scroll-view scroll-y="true">\n    \x3c!--登录--\x3e\n    <view class="index-login">\n     <view class="index-login-left">\n      <image class="index-login-left-img" :src="userInfo.avatarUrl"></image>\n     </view>\n     <text class="idnex-login-text">{{ userInfo.nickName ||  \'未登录\' }}</text>\n     \x3c!--#ifdef MP-WEIXIN--\x3e \n      <button type="sumbit" plain="true" size="mini" open-type="getUserInfo" @tap="login" @click="change" >{{ logState }}</button>\n     \x3c!--#endif--\x3e\n    </view>\n   </scroll-view>\n  </view>\n </view>\n</template>\n<script>\n // 引入css\n import \'../../common/iconfont.css\'\n // 引入接口\n import { topList } from \'../../common/api.js\'\n export default {\n  data() {\n   return {\n    topList : [],\n    userInfo : {},\n    logState : \'立即登录\',\n   };\n  },\n  onLoad(){ }，\n  methods: {\n   // 登录部分\n   login(){\n    // 获取code 小程序专有，用户登录凭证。\n    uni.getUserProfile({\n     desc: "获取用户基本资料",\n     success : (res)=>{\n      this.userInfo = res.userInfo;\n     },\n     // 用户取消登录后的提示\n     fail: (res)=>{\n      uni.showModal({\n       title:"授权用户信息失败！",\n       // 是否显示取消按钮，默认为 true\n       showCancel:false\n      })\n     }\n    })\n    //获取成功基本资料后开启登录，基本资料首先要授权\n    uni.login({\n     provider : \'weixin\',\n     success : (res)=>{\n      console.log(res);\n      if(res.errMsg == "login:ok"){\n       let code =res.code;\n      }\n     }\n    })\n   },\n   // 退出登录\n   change(){\n    // 这里只是改变了按钮文字内容，真正退出需要清除token，回到首页,还没找到头绪怎么做\n    this.logState = \'已登录\';\n   }\n  }\n<\/script>\n<style>\n /*登录*/\n .index-login{ margin: auto; width:379px; }\n .index-login-left{ width:35px; height:35px;  position: absolute; overflow: hidden; background: url(../../static/user.png); }\n .index-login-left-img{ width:35px; height:35px;  border-radius: 50%; }\n .index-login-img-text{ font-size:34px; color:#dddddd; }\n .idnex-login-text{ font-size:14px; vertical-align: sub; margin-left: 45px; color:#888; }\n .index-login button{ float:right; border:1px #dddddd solid; border-radius: 30px; }\n</style>\n\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br"),a("span",{staticClass:"line-number"},[s._v("48")]),a("br"),a("span",{staticClass:"line-number"},[s._v("49")]),a("br"),a("span",{staticClass:"line-number"},[s._v("50")]),a("br"),a("span",{staticClass:"line-number"},[s._v("51")]),a("br"),a("span",{staticClass:"line-number"},[s._v("52")]),a("br"),a("span",{staticClass:"line-number"},[s._v("53")]),a("br"),a("span",{staticClass:"line-number"},[s._v("54")]),a("br"),a("span",{staticClass:"line-number"},[s._v("55")]),a("br"),a("span",{staticClass:"line-number"},[s._v("56")]),a("br"),a("span",{staticClass:"line-number"},[s._v("57")]),a("br"),a("span",{staticClass:"line-number"},[s._v("58")]),a("br"),a("span",{staticClass:"line-number"},[s._v("59")]),a("br"),a("span",{staticClass:"line-number"},[s._v("60")]),a("br"),a("span",{staticClass:"line-number"},[s._v("61")]),a("br"),a("span",{staticClass:"line-number"},[s._v("62")]),a("br"),a("span",{staticClass:"line-number"},[s._v("63")]),a("br"),a("span",{staticClass:"line-number"},[s._v("64")]),a("br"),a("span",{staticClass:"line-number"},[s._v("65")]),a("br"),a("span",{staticClass:"line-number"},[s._v("66")]),a("br"),a("span",{staticClass:"line-number"},[s._v("67")]),a("br"),a("span",{staticClass:"line-number"},[s._v("68")]),a("br"),a("span",{staticClass:"line-number"},[s._v("69")]),a("br"),a("span",{staticClass:"line-number"},[s._v("70")]),a("br"),a("span",{staticClass:"line-number"},[s._v("71")]),a("br"),a("span",{staticClass:"line-number"},[s._v("72")]),a("br"),a("span",{staticClass:"line-number"},[s._v("73")]),a("br"),a("span",{staticClass:"line-number"},[s._v("74")]),a("br"),a("span",{staticClass:"line-number"},[s._v("75")]),a("br"),a("span",{staticClass:"line-number"},[s._v("76")]),a("br"),a("span",{staticClass:"line-number"},[s._v("77")]),a("br"),a("span",{staticClass:"line-number"},[s._v("78")]),a("br"),a("span",{staticClass:"line-number"},[s._v("79")]),a("br")])])])}),[],!1,null,null,null);n.default=t.exports}}]);